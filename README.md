# 市场比值分析工具 📊

基于MT5平台的市场比值分析工具，使用4小时K线数据分析主流金融市场的比值关系，帮助投资者识别市场趋势和相对强弱。

## 功能特点 ✨

- 📈 **5大主流比值分析**：金银比、金铂比、油金比、纳指/标普比、道指/黄金比
- 🕐 **4小时精度**：使用4小时K线数据，平衡精度和长期趋势
- 📅 **5年历史数据**：覆盖完整的市场周期
- 🎨 **可视化图表**：自动生成高清图表，包含均值、标准差区间
- 📊 **智能分析**：自动判断当前值是偏高、偏低还是正常
- 💾 **数据导出**：CSV格式导出，方便进一步分析

## 支持的比值分析 📋

### 1. 金银比 (XAUUSD/XAGUSD)
**经典避险金属比值，历史均值约80，投资者最关注**

- 比值高：黄金相对白银强势，通常出现在经济不确定时期
- 比值低：白银相对黄金强势，通常出现在经济复苏或工业需求旺盛时期
- 历史范围：40-120

### 2. 金铂比 (XAUUSD/XPTUSD)
**贵金属工业需求对比，铂金用于汽车催化剂和珠宝**

- 比值高：黄金相对铂金强势，避险需求大或汽车工业疲软
- 比值低：铂金相对黄金强势，工业需求旺盛
- 历史范围：1.4-3.6

### 3. 油金比 (XTIUSD/XAUUSD)
**经济活力指标，油价高说明经济强劲，金价高说明避险需求**

- 比值高：原油相对黄金强势，经济活力强，风险偏好高
- 比值低：黄金相对原油强势，避险情绪浓，经济担忧
- 历史范围：0.01-0.07

### 4. 纳指/标普比 (NAS100/US500)
**科技股vs大盘，比值高说明科技股强势**

- 比值高：科技股表现优于大盘，成长股受追捧
- 比值低：大盘股表现优于科技股，价值股受青睐
- 历史范围：2.8-3.8

### 5. 道指/黄金比 (US30/XAUUSD)
**股市vs避险，比值高说明风险偏好强，低说明避险情绪浓**

- 比值高：股市相对黄金强势，风险偏好高，经济乐观
- 比值低：黄金相对股市强势，避险需求大，市场担忧
- 历史范围：8.8-20.4

## 安装要求 🔧

### 必需软件
- Windows操作系统
- MetaTrader 5终端（已安装并登录）
- Python 3.8+

### Python依赖
```bash
pip install MetaTrader5 pandas matplotlib
```

## 快速开始 🚀

### 1. 检查数据可用性
```bash
python check_h4_data_availability.py
```
检查MT5平台上各品种的4小时数据是否完整。

### 2. 批量分析所有比值
```bash
python analyze_all_ratios.py
```
一次性分析所有5个主流比值，生成综合图表和汇总报告。

### 3. 单独分析金银比
```bash
python gold_silver_ratio_chart.py
```
专门分析金银比，生成详细图表。

### 4. 交互式分析
```bash
python market_ratio_analyzer.py
```
交互式选择要分析的比值、时间范围和周期。

## 输出文件 📁

### 图表文件
- `市场比值综合分析_YYYYMMDD_HHMMSS.png` - 包含所有5个比值的综合图表
- `金银比_YYYYMMDD_HHMMSS.png` - 单独的金银比图表

### 数据文件
- `金银比_data_YYYYMMDD_HHMMSS.csv` - 金银比历史数据
- `金铂比_data_YYYYMMDD_HHMMSS.csv` - 金铂比历史数据
- `油金比_data_YYYYMMDD_HHMMSS.csv` - 油金比历史数据
- `纳指标普比_data_YYYYMMDD_HHMMSS.csv` - 纳指/标普比历史数据
- `道指黄金比_data_YYYYMMDD_HHMMSS.csv` - 道指/黄金比历史数据

### 汇总报告
- `市场比值汇总_YYYYMMDD_HHMMSS.csv` - 包含所有比值的当前状态和统计信息

## 使用示例 💡

### 示例1：快速了解当前市场状态
```bash
python analyze_all_ratios.py
```
查看汇总报告，了解各个比值的当前状态（偏高/偏低/正常）。

### 示例2：深入研究金银比
```bash
python gold_silver_ratio_chart.py
```
获取金银比的详细统计信息和历史走势图。

### 示例3：自定义分析
```bash
python market_ratio_analyzer.py
```
选择特定比值，自定义时间范围（如3年、10年）和时间周期（如H1、D1）。

## 项目结构 📂

```
market_ratio_analysis/
├── README.md                          # 项目说明文档
├── USAGE.md                           # 详细使用指南
├── analyze_all_ratios.py             # 批量分析所有比值
├── gold_silver_ratio_chart.py        # 金银比专项分析
├── market_ratio_analyzer.py          # 交互式比值分析工具
├── check_h4_data_availability.py     # 数据可用性检查
└── examples/                          # 示例输出文件
    ├── 市场比值综合分析_示例.png
    ├── 金银比_示例.png
    └── 市场比值汇总_示例.csv
```

## 技术细节 🔬

### 数据来源
- 数据源：MetaTrader 5平台
- 时间周期：4小时K线（H4）
- 数据范围：默认5年（约4400-4500个数据点）
- 价格类型：收盘价（Close）

### 统计方法
- **均值**：算术平均值，作为历史中枢参考
- **标准差**：衡量波动性，±1标准差覆盖约68%的数据
- **分位数**：当前值在历史数据中的排名百分比
- **状态判断**：
  - 偏高：当前值 > 均值 + 1标准差
  - 偏低：当前值 < 均值 - 1标准差
  - 正常：在±1标准差范围内

### 图表说明
- **金色曲线**：比值的历史走势
- **红色虚线**：历史平均值
- **橙色阴影**：±1标准差区间（正常波动范围）
- **浅红阴影**：±2标准差区间（极端波动范围）
- **统计框**：当前值、分位数、状态

## 投资建议 ⚠️

本工具仅供参考，不构成投资建议。市场比值分析是技术分析的一种方法，应结合基本面分析、风险管理等多方面因素综合判断。

**风险提示：**
- 历史数据不代表未来表现
- 比值的"正常"范围会随市场环境变化
- 极端值可能持续较长时间
- 建议结合其他技术指标和基本面分析

## 常见问题 ❓

### Q: 为什么选择4小时周期？
A: 4小时周期平衡了数据精度和长期趋势，既能捕捉中期波动，又能保持足够的历史数据量。

### Q: 数据不完整怎么办？
A: 运行 `check_h4_data_availability.py` 检查数据可用性。如果某些品种不可用，可能是MT5账户权限问题或品种名称不同。

### Q: 可以分析其他比值吗？
A: 可以！修改 `market_ratio_analyzer.py` 中的 `RATIO_PRESETS` 配置，添加你想分析的品种对。

### Q: 如何解读"分位数"？
A: 分位数表示当前值在历史数据中的排名。例如，分位数5%表示当前值低于95%的历史数据，处于历史低位。

## 更新日志 📝

### v1.0.0 (2026-02-09)
- ✨ 初始版本发布
- 📊 支持5大主流比值分析
- 🎨 自动生成可视化图表
- 📈 智能状态判断和市场解读
- 💾 CSV数据导出功能

## 贡献 🤝

欢迎提交Issue和Pull Request！

## 许可证 📄

MIT License

## 联系方式 📧

如有问题或建议，欢迎通过GitHub Issues联系。

---

**免责声明**：本工具仅供学习和研究使用，不构成任何投资建议。投资有风险，入市需谨慎。
